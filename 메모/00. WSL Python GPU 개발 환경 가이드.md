WSL2 Python GPU 개발 환경 완벽 구축 가이드 (상세 버전)
이 가이드는 깨끗한 Windows 환경에서 시작하여 WSL2(Ubuntu)에 GPU를 사용하는 Python 개발 환경을 구축하는 모든 과정을 다룹니다. 각 명령어와 옵션에 대한 상세한 설명을 포함하여 전체 흐름을 완벽하게 이해할 수 있도록 구성했습니다.

Phase 0: 사전 준비 (Windows PowerShell)
※ 중요: PowerShell을 **'관리자 권한'**으로 실행하세요.

설치 가능한 Linux 배포판 목록 확인

WSL을 통해 설치할 수 있는 공식 배포판들의 목록을 확인합니다. 이 목록을 보고 원하는 버전을 선택할 수 있습니다.

wsl --list --online
# --list: 설치된 배포판 목록을 보여줍니다.
# --online: 로컬이 아닌 온라인에서 설치 가능한 배포판 목록을 보여줍니다.

Phase 1: WSL 및 Ubuntu 설치 (Windows PowerShell)
WSL 설치 및 Ubuntu 22.04 배포판 다운로드/설치

이 명령어 하나로 WSL 기능 활성화, 가상 머신 플랫폼 활성화, 최신 Linux 커널 다운로드, 지정된 Ubuntu 배포판 설치까지 모두 자동으로 진행됩니다.

wsl --install -d Ubuntu-22.04
# --install: WSL 및 기본 배포판(Ubuntu) 설치를 진행합니다.
# -d, --distribution: 설치할 Linux 배포판을 'Ubuntu-22.04'로 지정합니다.

컴퓨터 재부팅

설치가 완료되면 컴퓨터를 재부팅하라는 메시지가 나타날 수 있습니다. 메시지에 따라 재부팅합니다.

Ubuntu 초기 설정

재부팅 후 Ubuntu 터미널이 자동으로 실행됩니다. (실행되지 않으면 시작 메뉴에서 'Ubuntu'를 찾아 실행)

사용할 사용자 이름(영문 소문자)과 비밀번호를 설정합니다. (비밀번호 입력 시 화면에 아무것도 표시되지 않는 것이 정상입니다.)

Phase 2: Ubuntu 초기 설정 및 시스템 업데이트 (Ubuntu 터미널)
※ 이제부터 모든 작업은 Ubuntu 터미널에서 진행합니다.

패키지 목록 업데이트 및 시스템 업그레이드

설치된 패키지들을 최신 상태로 만들고, 보안 패치 등을 적용합니다.

sudo apt update && sudo apt upgrade -y
# sudo: 'superuser do', 관리자 권한으로 명령어를 실행합니다.
# apt update: 패키지 저장소에서 사용 가능한 패키지들의 최신 목록을 가져옵니다.
# &&: 앞의 명령어가 성공적으로 완료되면, 뒤의 명령어를 실행합니다.
# apt upgrade: 시스템에 설치된 패키지들을 최신 버전으로 업그레이드합니다.
# -y, --yes: 모든 확인 질문(Y/n)에 자동으로 'Yes'라고 답합니다.

Phase 3: GPU 드라이버 연결 확인
NVIDIA 드라이버 공유 확인

Windows에 설치된 NVIDIA 드라이버를 WSL이 정상적으로 인식하는지 확인합니다.

nvidia-smi

GPU 정보와 CUDA Version이 표시되면 성공입니다. 만약 command not found 오류가 발생하면 Windows에 최신 NVIDIA Game Ready 또는 Studio 드라이버를 설치해야 합니다.

Phase 4: CUDA Toolkit 설치 (WSL Ubuntu 호스트)
필수 패키지 설치

sudo apt install -y gpg wget
# gpg: 암호화 및 서명 도구 (NVIDIA 저장소 키 관리에 필요)
# wget: 웹에서 파일을 다운로드하는 도구

NVIDIA CUDA 저장소 설정

NVIDIA의 공식 WSL용 저장소를 시스템에 추가하여 apt로 CUDA를 설치할 수 있게 합니다.

wget [https://developer.download.nvidia.com/compute/cuda/repos/wsl-ubuntu/x86_64/cuda-wsl-ubuntu.pin](https://developer.download.nvidia.com/compute/cuda/repos/wsl-ubuntu/x86_64/cuda-wsl-ubuntu.pin)
sudo mv cuda-wsl-ubuntu.pin /etc/apt/preferences.d/cuda-repository-pin-600
wget [https://developer.download.nvidia.com/compute/cuda/12.4.1/local_installers/cuda-repo-wsl-ubuntu-12-4-local_12.4.1-1_amd64.deb](https://developer.download.nvidia.com/compute/cuda/12.4.1/local_installers/cuda-repo-wsl-ubuntu-12-4-local_12.4.1-1_amd64.deb)
sudo dpkg -i cuda-repo-wsl-ubuntu-12-4-local_12.4.1-1_amd64.deb
# dpkg -i: 다운로드한 Debian 패키지(.deb) 파일을 설치합니다.
sudo cp /var/cuda-repo-wsl-ubuntu-12-4-local/cuda-*-keyring.gpg /usr/share/keyrings/
sudo apt-get update

CUDA Toolkit 설치

**cuda-toolkit**만 설치하여 드라이버 중복 설치를 방지합니다.

sudo apt-get -y install cuda-toolkit-12-4

환경 변수 설정

시스템이 CUDA Toolkit의 위치를 알 수 있도록 셸 설정 파일(.bashrc)에 경로를 추가합니다.

echo 'export PATH=/usr/local/cuda-12.4/bin${PATH:+:${PATH}}' >> ~/.bashrc
echo 'export LD_LIBRARY_PATH=/usr/local/cuda-12.4/lib64${LD_LIBRARY_PATH:+:${LD_LIBRARY_PATH}}' >> ~/.bashrc
# echo '...': 따옴표 안의 문자열을 출력합니다.
# >>: 리다이렉션 기호. echo의 출력 결과를 파일의 맨 뒤에 추가(append)합니다.
source ~/.bashrc
# source: 스크립트 파일을 현재 셸 세션에 바로 적용하여, 터미널 재시작 없이 변경사항을 반영합니다.

설치 확인

nvcc 명령어로 설치를 확인합니다.

nvcc --version

CUDA 컴파일러 정보가 표시되면 성공입니다.

Phase 5: Miniconda 및 가상환경 설정
Miniconda 설치 파일 다운로드

sudo apt install curl -y
curl [https://repo.anaconda.com/miniconda/Miniconda3-latest-Linux-x86_64.sh](https://repo.anaconda.com/miniconda/Miniconda3-latest-Linux-x86_64.sh) -o Miniconda3-latest-Linux-x86_64.sh
# curl: 웹에서 파일을 다운로드하는 도구.
# -o, --output: 다운로드한 파일을 저장할 이름(output)을 지정합니다.

Miniconda 설치

bash Miniconda3-latest-Linux-x86_64.sh -b -p $HOME/miniconda
# bash: 다운로드한 셸 스크립트 파일을 실행합니다.
# -b, --batch: 배치 모드. 사용자 입력(라이선스 동의 등) 없이 자동으로 설치를 진행합니다.
# -p, --prefix: Miniconda가 설치될 경로(prefix)를 지정합니다. ($HOME은 홈 디렉토리를 의미)

Conda 초기화 및 터미널 재시작

~/miniconda/bin/conda init

중요: 변경 사항을 적용하려면 터미널을 완전히 껐다가 다시 켜야 합니다.

Conda 가상환경 생성

conda create -n rag-env python=3.10 -y
# create: 새로운 가상환경을 생성합니다.
# -n, --name: 생성할 가상환경의 이름을 'rag-env'로 지정합니다.

가상환경 활성화

conda activate rag-env

프롬프트 맨 앞에 (rag-env)가 표시되면 활성화된 것입니다.

Phase 6: GPU 라이브러리 설치 (Conda 가상환경 내부)
PyTorch 설치

CUDA 12.1을 지원하는 PyTorch를 공식 채널에서 설치합니다. (PyTorch는 하위 버전의 CUDA Toolkit과 호환됩니다.)

conda install pytorch torchvision torchaudio pytorch-cuda=12.1 -c pytorch -c nvidia -y
# -c, --channel: 패키지를 다운로드할 특정 채널(저장소)을 지정합니다.

Faiss 및 기타 RAG 필수 라이브러리 설치

pip install faiss-gpu langchain openai transformers datasets sentence-transformers

Phase 7: 최종 확인
Python에서 GPU 인식 확인

python

Python 코드 입력

import torch
print(f"PyTorch version: {torch.__version__}")
print(f"CUDA available: {torch.cuda.is_available()}")
if torch.cuda.is_available():
    print(f"CUDA version: {torch.version.cuda}")
    print(f"GPU name: {torch.cuda.get_device_name(0)}")

결과 확인

CUDA available: True와 함께 GPU 이름이 정상적으로 출력된다면, 모든 설정이 완벽하게 완료된 것입니다.

exit()를 입력하여 Python을 종료합니다.

이제 GPU를 사용하는 Python 개발을 시작할 준비가 모두 끝났습니다!