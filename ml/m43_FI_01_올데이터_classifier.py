### <<36>>

# feature_importances : 트리기반모델에서만 제공

from sklearn.datasets import load_breast_cancer, load_wine, load_digits
from sklearn.tree import DecisionTreeClassifier
from sklearn.ensemble import RandomForestClassifier, GradientBoostingClassifier
from xgboost import XGBClassifier
from sklearn.model_selection import train_test_split
import random
import numpy as np
from sklearn.preprocessing import StandardScaler

seed = 123
random.seed(seed)
np.random.seed(seed)

# 1. 데이터
data1 = load_breast_cancer()
data2 = load_wine()
data3 = load_digits()

datasets = [data1, data2, data3]
dataset_name = ['cancer', 'wine', 'digits']

model1 = DecisionTreeClassifier(random_state=seed)
model2 = RandomForestClassifier(random_state=seed)
model3 = GradientBoostingClassifier(random_state=seed)
model4 = XGBClassifier(random_state=seed)
models = [model1, model2, model3, model4]

for i, data in enumerate(datasets):
    x = data.data
    y = data.target
    
    x_train, x_test, y_train, y_test = train_test_split(
        x, y, train_size=0.8, random_state=seed,
        stratify=y,
    )
    
    scaler = StandardScaler()
    x_train = scaler.fit_transform(x_train)
    x_test = scaler.transform(x_test)
    
    print("================================", dataset_name[i], "====================================")

    # 2. 모델
    for model in models:
        model.fit(x_train, y_train)
        print("=========", model.__class__.__name__, "========")
        print('acc :', model.score(x_test, y_test))
        print(model.feature_importances_)

"""
================================ cancer ====================================
========= DecisionTreeClassifier ========
acc : 0.9649122807017544
[0.         0.06273793 0.         0.         0.         0.01526295
 0.02935689 0.         0.         0.         0.00845201 0.
 0.         0.00299583 0.00176805 0.         0.         0.
 0.         0.         0.         0.00935341 0.01126935 0.70338504
 0.         0.0075129  0.         0.13883012 0.         0.00907551]
========= RandomForestClassifier ========
acc : 0.9649122807017544
[0.03478211 0.01557829 0.0459482  0.03416012 0.00556238 0.01060344
 0.04718969 0.11448056 0.00424821 0.00485112 0.00997732 0.00548392
 0.01423695 0.04531858 0.00546883 0.0033865  0.00368638 0.00373007
 0.00519236 0.00448305 0.10003604 0.02099376 0.13171482 0.12161194
 0.01105595 0.01246917 0.02174541 0.14176168 0.01172847 0.00851465]
========= GradientBoostingClassifier ========
acc : 0.9824561403508771
[8.09337928e-04 2.79188127e-02 1.82804919e-03 6.91162477e-04
 7.67506845e-04 7.46475594e-04 1.07222952e-02 4.24567119e-02
 1.55225110e-03 3.46808359e-04 6.56185357e-03 8.02673831e-03
 3.60745460e-03 4.73585436e-03 1.69672398e-03 1.41303152e-03
 9.36282481e-04 3.04167040e-03 1.07152836e-03 1.24568531e-03
 1.22826375e-03 4.25649685e-02 2.33328024e-01 4.70853591e-01
 3.98644743e-03 1.15958405e-03 1.44329185e-02 1.09103568e-01
 5.75160138e-04 2.59124013e-03]
========= XGBClassifier ========
acc : 0.9912280701754386
[0.01815764 0.01569501 0.         0.0032644  0.00396126 0.00207543
 0.00426753 0.06830692 0.00221316 0.00328998 0.01382377 0.00926016
 0.0153579  0.01026187 0.0181306  0.00254898 0.         0.01395431
 0.00322362 0.00251621 0.00386465 0.02203292 0.6079987  0.05683359
 0.01485889 0.00435244 0.01172198 0.05729257 0.00671581 0.00401975]
================================ wine ====================================
========= DecisionTreeClassifier ========
acc : 0.8888888888888888
[0.         0.         0.02097754 0.         0.         0.
 0.40558571 0.         0.         0.38697541 0.02086548 0.02013843
 0.14545744]
========= RandomForestClassifier ========
acc : 0.9722222222222222
[0.10934824 0.01462304 0.02344088 0.0361169  0.03513885 0.05129076
 0.16452625 0.01143186 0.01652169 0.14983877 0.06028309 0.15378592
 0.17365375]
========= GradientBoostingClassifier ========
acc : 0.9166666666666666
[3.24710445e-03 4.27494060e-02 1.20560648e-02 5.88562366e-03
 0.00000000e+00 7.99112792e-03 2.97427791e-01 2.45026369e-04
 2.54620734e-03 3.16182468e-01 1.19192685e-02 2.27539662e-02
 2.76995945e-01]
========= XGBClassifier ========
acc : 0.9444444444444444
[0.0633141  0.08874952 0.01123517 0.00261207 0.03230456 0.02632484
 0.22729877 0.         0.01110675 0.2843193  0.03778306 0.02962446
 0.18532743]
================================ digits ====================================
========= DecisionTreeClassifier ========
acc : 0.8777777777777778
[0.         0.         0.01495656 0.01175198 0.0029489  0.0636326
 0.00206196 0.         0.00153241 0.00511367 0.01103962 0.00154647
 0.01961319 0.01131752 0.00103098 0.         0.         0.
 0.00967995 0.01926051 0.04495181 0.09117231 0.00077323 0.
 0.00151873 0.00403481 0.04825186 0.04840584 0.01006443 0.01471022
 0.01287119 0.         0.         0.05222661 0.02597732 0.00367286
 0.07393944 0.0240984  0.00865615 0.         0.         0.00362377
 0.12022195 0.04954231 0.01751676 0.00780317 0.00938992 0.
 0.         0.         0.01084162 0.00742789 0.00734935 0.01405183
 0.026943   0.         0.         0.         0.00993984 0.00077323
 0.06172262 0.00516895 0.00687225 0.        ]
========= RandomForestClassifier ========
acc : 0.9944444444444445
[0.00000000e+00 1.42941806e-03 2.29312800e-02 9.38339068e-03
 1.07042076e-02 1.97869289e-02 9.77059523e-03 6.48843270e-04
 3.73828037e-05 1.14173327e-02 2.55843826e-02 7.12932464e-03
 1.77956946e-02 2.52151245e-02 5.46570040e-03 8.45747100e-04
 1.28960487e-04 7.02466920e-03 2.02032293e-02 2.49852526e-02
 2.99230029e-02 5.00618358e-02 8.00770620e-03 2.09514189e-04
 8.48975156e-05 1.58557625e-02 3.88196573e-02 2.68794283e-02
 3.37348812e-02 1.98447126e-02 3.30250581e-02 7.79656356e-05
 0.00000000e+00 2.47093505e-02 3.05421892e-02 1.92416681e-02
 3.88365930e-02 2.25116977e-02 2.36489634e-02 0.00000000e+00
 1.47232223e-05 1.20528860e-02 3.45989647e-02 4.62534288e-02
 2.31937922e-02 1.79825926e-02 1.92137017e-02 2.26586891e-05
 4.65569924e-05 3.29748008e-03 1.76864863e-02 2.01848619e-02
 1.08834795e-02 2.42087990e-02 2.64932330e-02 1.45880956e-03
 1.18788604e-05 2.36634736e-03 2.09762357e-02 1.10445152e-02
 2.19879095e-02 2.73733365e-02 1.85621610e-02 3.58281280e-03]
========= GradientBoostingClassifier ========
acc : 0.9694444444444444
[0.00000000e+00 3.34850729e-04 1.13666903e-02 5.37946965e-03
 1.33629723e-03 5.38868844e-02 5.62976162e-03 2.06409448e-04
 2.37620095e-04 3.68310066e-03 2.16497552e-02 1.27326502e-03
 7.64380471e-03 1.53071799e-02 5.46135196e-03 1.06531693e-03
 2.29803127e-04 3.18742240e-03 1.36956868e-02 4.19078845e-02
 2.09525439e-02 9.66135212e-02 3.44322355e-03 1.46115795e-04
 2.33099739e-05 5.56624358e-04 4.36279637e-02 2.18759456e-02
 2.46646284e-02 2.11383370e-02 9.44668177e-03 5.29478881e-04
 0.00000000e+00 6.95889127e-02 3.44261845e-03 3.94966325e-03
 6.73121197e-02 1.19630129e-02 1.84789074e-02 0.00000000e+00
 5.48260640e-07 6.02231995e-03 8.24472531e-02 7.10340397e-02
 1.44889441e-02 2.00352127e-02 2.90972256e-02 2.18744805e-04
 1.87490331e-06 2.87523468e-03 7.63833102e-03 9.56549645e-03
 5.59112530e-03 8.91342169e-03 2.73720494e-02 3.95398076e-05
 6.35381531e-04 3.45469814e-04 8.17808310e-03 2.19533529e-03
 5.43991433e-02 1.02673141e-02 2.03822169e-02 7.01953156e-03]
========= XGBClassifier ========
acc : 0.975
[0.         0.06415373 0.01059751 0.00873501 0.00434788 0.03380749
 0.00921624 0.01642124 0.         0.01852774 0.01413111 0.01034479
 0.00841835 0.01131467 0.00558309 0.00333757 0.         0.00507369
 0.00538672 0.04030624 0.01079499 0.04513224 0.00413447 0.
 0.         0.00495149 0.02641704 0.00841728 0.02751666 0.01865148
 0.01018624 0.         0.         0.07354813 0.00440697 0.00674871
 0.04887262 0.01661007 0.02459871 0.         0.         0.00697014
 0.03422127 0.04050089 0.0116045  0.01881086 0.02428929 0.
 0.         0.00862246 0.005208   0.00565973 0.01122131 0.0095808
 0.02874239 0.         0.         0.04148491 0.00863673 0.00476112
 0.06507792 0.01276453 0.04295827 0.01819468]
 
"""